\section{The Taxation Mechanism}\label{sec:taxation}

In this section we explore the necessary properties and core limitations of a
taxation mechanism.

\paragraph{Properties.}

In every cryptocurrency system, a user, \eg an exchange $\exchange$, manages
their assets via \emph{addresses}. Every address $\address$ is associated with
a key pair $\keypair$, such that the private key $\signkey$ is used to claim
ownership of the assets, \eg by signing special messages; in Bitcoin, as well
as most cryptocurrency systems, $\address = \mathsf{H}(\signkey)$ for some hash
function $\mathsf{H}$.  Assuming $[\address_1, \dots, \address_n]$ is the list
of all addresses that $\exchange$ controls, the total amount of assets that it
owns is $\assets = \sum_{i=1}^n \text{bal}(\address_i)$, where
$\text{bal}(\address)$ is the amount of assets controlled by the address
$\address$; the balance of every address is publicly available on the
blockchain.

The minimum requirement for a taxation mechanism for cryptocurrency is that the
exchange $\exchange$ declares its assets to the taxation authority $\taxAuth$.
Our goal is to design a mechanism that enables taxation, while retaining as
much privacy as possible. Ideally, the only information that is leaked to
$\taxAuth$ should be $\assets$, while ensuring a provably correct declaration.
In other words, without revealing the address, the exchange should be able to
provide a zero-knowledge proof of knowledge of the private key for every
address for which it claims ownership.

\paragraph{Limitations.}

Assume that an exchange $\exchange$ tax evades, \ie creates a secret,
undeclared address $\address$ and sends some assets $\theta$ to it. As long as
the keeps the address hidden, \ie does not use it, it is impossible for any
party to any party to identify or prove that $\exchange$ owns $\address$ and,
consequently, $\theta$.

Now assume that, at some future point, the exchange issues a transaction $\tau$
which sends $\theta$ assets from $\address$ to a party $\user$, \eg when
$\user$ requests a withdrawal from the exchange. If $\user$ suspects that the
exchange evaded taxation for the $\theta$ assets, they might want to report the
exchange to the taxation authority $\taxAuth$ for inspection, \ie they form a
complaint that $\exchange$ owns $\address$ and tax evades via it.

When $\taxAuth$ receives the user's complaint, it faces a problem. Even if
$\taxAuth$ has proof that $\exchange$ did not declare $\address$ for taxation,
it further needs proof that $\address$ is controlled by the exchange, \ie proof
that the exchange knows the private key that pertains to $\address$. The reason
is that it cannot know if the $\user$ is lying, \ie if $\address$ is not
controlled by $\exchange$ but by $\user$ themselves. In other words, $\taxAuth$
needs to distinguish between two scenarios:
\begin{inparaenum}[i)]
    \item $\exchange$ controls $\address$ and tax evades, or
    \item $\user$ is lying about $\exchange$ owning $\address$.
\end{inparaenum}

Observe that, in the first scenario, $\user$ does know that $\address$ is
controlled by $\exchange$. However, due to the pseudonymity of Bitcoin, the
transaction $\tau$ is not sufficient to prove this fact. Instead, $\user$
needs a proof which can only be supplied by the exchange, \eg a signature from
the exchange's public key which acknowledges $\tau$ or $\address$. However, if
$\exchange$ does tax evade via $\address$, it is unreasonable to assume that it
would create such proof, which would effectively incriminate itself.

\paragraph{Design.}

In designing our taxation mechanism we keep in mind that, in case an exchange
$\exchange$ evades taxation for some address $\address$, a user who receives
some assets from $\address$ should be able to identify the evasion.  We ensure
this by enabling every user to request a taxation proof \emph{after} the
transaction has been issued, \ie after $\exchange$ has committed to owning an
address $\address$. If $\exchange$ fails to provide such proof, then the user
can safely assume that $\exchange$ evaded taxation via $\address$.

Due to the limitations described above, it is not sufficient that any user
identifies the evasion, instead the taxation authority $\taxAuth$ itself should
observe it. Therefore, we also require that $\exchange$ does not know whether
the user will request a taxation proof after the transaction is issued. This is
important since, if $\exchange$ knows a priori that a user will request a
taxation proof, it will instead use a legitimate address, \ie an address which
is declared for taxation.

Now, we assume that $\taxAuth$ covertly becomes a user of the exchange and,
upon performing a withdrawal, requests a taxation proof. If, for this specific
transaction, the exchange uses a tax evading address, $\taxAuth$ will identify
the tax evasion.
