\section{A Taxable Ledger}\label{sec:taxchain}

In this section we describe a ledger which enables taxation. Our mechanism is
generic enough, such that existing distributed ledgers can incorporate it via a
change in the consensus protocol.

A taxable ledger aims to enable a user $\user$ to declare the amount of
crypto-assets they own to a taxation authority $\taxAuth$. In achieving this,
we aim at a high level of privacy. Ideally, we want only the total amount of
assets that $\user$ owns to be leaked to $\taxAuth$. However, given the
underlying structure of the ledger, it is possible that additional information
is leaked; \eg in a pseudonymous setting like Bitcoin, one or more of the
addresses might be linked to the user who owns them.

\paragraph{Assumptions.}

We assume that the tax authority $\taxAuth$ has a list $P$ of all taxpayers.
Additionally, we assume the existence of taxation periods which last $d$ time;
\eg a taxation period lasts $1$ year, at the end of which the taxpayers are
required to declare their assets. Naturally, both assumptions are in line with
how real-world tax systems operate. Finally, we assume a key
$\keypair_\taxAuth$ which is controlled by and identifies $\taxAuth$ and is
published on the ledger.

The core idea behind our scheme is to freeze assets which are not accounted
for. In particular, assume a taxation period $d_i$. At the end of the taxation
period, all users are required to declare their assets with $\taxAuth$.
However, as we saw in Section~\ref{sec:taxation}, unless we assume a complete
lack of privacy, it is impossible to account assets that a user hides in a
newly-created address. However, what we can do is freeze assets until they have
been accounted for.

\paragraph{Design.}

After the taxation period ends and all assets are frozen, $\taxAuth$ needs to
provide a method for users to declare their assets. Additionally, there should
be established a mechanism such that, when a user declares their assets, then
the assets are unfrozen.

When a taxpayer $\user$ wishes to move frozen assets (either unfreeze their own
or receive frozen assets from a third party), they create a new key pair
$\keypair_\user$ and the corresponding address $\address_\user$. Then they send
$\address_\user$ to $\taxAuth$. Next, $\taxAuth$ certifies $\address_\user$, by
issuing the signature $\sig = \algosign(\address_\user, \signkey_\taxAuth)$,
and returns $\sig$ to $\user$. The tuple $\address_\user^{t} = \langle
\address_\user, \sig \rangle$ is the ``taxation'' address which is used by the
user to receive frozen assets. Additionally, $\taxAuth$ maintains a mapping of
taxpayers to taxation addresses, \ie for every taxpayer $\user$ it holds a list
$A_\user$ of all taxation addresses certified for $\user$ such as
$\address_\user$.

A transaction $\tau = \langle \address_{source}, \address_{dest}, x \rangle$
which moves $x$ frozen assets from the address $\address_{source}$ is valid
only if $\address_{dest} = \langle \address, \sig \rangle:
\algoverify(\address, \sig, \verifykey_\taxAuth) = 1$. Therefore, the miners
will accept transactions that unfreeze assets only as long as said assets are
transferred to a taxation address.

Afterwards, $\taxAuth$ can find the amount of assets for which $\user$ should
be taxed by computing $\assets_\user := \sum_{i=1}^{n} \balance(A_{\user}[i])$,
where $n$ is the total number of $\user$'s taxation addresses.

\emph{Note:} The above system can be extended to accommodate multiple taxation
authorities, \eg for a list of countries. In that case, $\taxAuth$ is treated
as a federation of authorities, each identified by a single key, and
$\keypair_\taxAuth$ is the list of keys for all taxation authorities. A
taxpayer can then certify its address with the authority of their country of
residence and thus declare their assets only to this authority.

\paragraph{Challenges.}

\begin{itemize}
    \item A taxation address is larger compared to the single address, \eg
        ECDSA signatures in DER format are approximately $72$
        bytes\footnote{\url{https://stackoverflow.com/a/17312872}}.
    \item Should assets remain frozen forever? If so, the authority needs to
        maintain the taxation address mapping forever, which might be
        significant cost.
\end{itemize}
